"use strict";angular.module("gifmachineApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","webcam"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/previewGIF",{templateUrl:"views/previewGIF.html",controller:"PreviewCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/gifs",{templateUrl:"views/show_gif.html",controller:"ShowGifCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope",function(a){a.currentImages=[],a.createdGifs=[]}]),angular.module("gifmachineApp").controller("MainCtrl",["$scope","$rootScope","$location",function(a,b,c){var d=null,e=null;a.showDemos=!1,a.edgeDetection=!1,a.mono=!1,a.invert=!1,a.images=b.currentImages||[],a.patOpts={x:0,y:0,w:25,h:25},a.webcamError=!1,a.onError=function(b){a.$apply(function(){a.webcamError=b,c.path("/")})},a.onSuccess=function(b){d=b,a.$apply(function(){a.patOpts.w=d.width,a.patOpts.h=d.height,a.showDemos=!0,a.isCameraStarted=!0})},a.onStream=function(){},a.clearImages=function(){a.images=[],b.currentImages=[]},a.previewGIF=function(){b.currentImages=a.images,c.path("/previewGIF")},a.makeSnapshot=function(){if(d){var b=document.querySelector("#snapshot");if(!b)return;b.width=d.width,b.height=d.height;var c=b.getContext("2d"),g=f(a.patOpts.x,a.patOpts.y,a.patOpts.w,a.patOpts.h);c.putImageData(g,0,0),e=g;var h=b.toDataURL();a.images.push(h)}};var f=function(a,b,c,e){var f=document.createElement("canvas");f.width=d.width,f.height=d.height;var g=f.getContext("2d");return g.drawImage(d,0,0,d.width,d.height),g.getImageData(a,b,c,e)}}]),angular.module("gifmachineApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);var myBlob;angular.module("gifmachineApp").controller("PreviewCtrl",["$scope","$rootScope","$location",function(a,b,c){a.images=b.currentImages,a.createGIF=function(){var d=document.createElement("img");d.addEventListener("load",function(){var e=new GIF({workers:2,quality:1,workerScript:location.pathname+"scripts/vendors/gif.worker.js",width:d.width,height:d.height});$("img").each(function(){e.addFrame($(this)[0])}),e.on("progress",function(b){a.$apply(function(){a.status=b})}),e.on("finished",function(d){a.$apply(function(){var e=new FileReader;e.readAsDataURL(d),e.onloadend=function(){a.$apply(function(){b.createdGifs.push(e.result),c.path("/gifs")})}})}),e.render()}),d.src=a.images[0]}}]);var myBlob;angular.module("gifmachineApp").controller("ShowGifCtrl",["$scope","$rootScope",function(a,b){a.images=b.createdGifs,a.latest_gif_data=a.images[a.images.length-1]}]);